\documentclass[a4paper]{article} % twoside for paper submission but remove for electronic submission
\title{Reconciling Resource Supply and Ontogenetic Growth (Models)}
\author{Luke Joseph Vassor}

%%%% Packages %%%

% Page Formatting packages
\usepackage[margin=2cm]{geometry}
\usepackage{lipsum} % Generates dummy text
\usepackage{titlesec}
    \titleformat*{\section}{\LARGE\bfseries}
    \titleformat*{\subsection}{\Large\bfseries}
    \titleformat*{\subsubsection}{\large\bfseries}
    \titleformat*{\paragraph}{\large\bfseries}
    \titleformat*{\subparagraph}{\large\bfseries}
    \newcommand{\sectionbreak}{\newpage} % forces new page for each section
    \titlespacing*{\section}
{0pt}{20cm plus 1ex minus .2ex}{4.3ex plus .2ex}
\usepackage{etoolbox}

\makeatletter
\patchcmd{\ttlh@hang}{\parindent\z@}{\parindent\z@\leavevmode}{}{}
\patchcmd{\ttlh@hang}{\noindent}{}{}{}
\makeatother
\usepackage{fancyhdr} % rule line and current section displayed at top of pages % \thispagestyle{empty} removes it on desired pages
    \pagestyle{fancy}
    \renewcommand{\footrulewidth}{0.4pt}% default is 0pt
    \renewcommand{\headrulewidth}{0.4pt}% default is 0pt
    \renewcommand{\sectionmark}[1]{\markboth{#1}{}} % set the \leftmark to section name
    \fancyhead[L]{\nouppercase{\leftmark}} %  sets the left head element ONLY EVER section name, otherwise mark is section/subsection/subsubsection
    \fancyhead[R]{} % sets the right head element to the page number if you use \thepage as argument
    \fancyfoot[C]{\thepage} % sets footer as page number

\usepackage{pdfpages}
% \usepackage{lscape}
% Math packages
\usepackage{amsmath}
\usepackage{amssymb}
% \usepackage{mathpazo}
\usepackage{xpatch}
\usepackage{cleveref}
% Language packages
% \usepackage[english]{babel}
\usepackage[utf8]{inputenc}    % utf8 support       %!!!!!!!!!!!!!!!!!!!!
\usepackage[T1]{fontenc}       % code for pdf file  %!!!!!!!!!!!!!!!!!!!!
% \usepackage{listings}

% Other packages
\usepackage{xcolor}
\usepackage{parskip}
\usepackage{hyperref}
    \hypersetup{colorlinks=false}
\usepackage{tocloft}
    \renewcommand{\cftsecleader}{\cftdotfill{\cftdotsep}} % for sections
% \usepackage[colorinlistoftodos]{todonotes}

% Plotting packages
% \usepackage{subfigure}
\usepackage[pyplot]{juliaplots}
\usepackage{wrapfig}
\usepackage{graphicx}
\usepackage[font=small,labelfont=bf]{caption} % Required for specifying captions to tables and figures
% Citation packages
\usepackage[maxcitenames=2, backend=biber, dashed=false, style=imperialharvard]{biblatex}
    \addbibresource{./CMEE_Thesis.bib}
    \setlength\bibitemsep{0.5\baselineskip}
    % \renewcommand*\finalnamedelim{\addspace\&\space}

% Force \textit{et al}. to be italicised

    \xpatchbibmacro{name:andothers}{%
        \bibstring{andothers}%
    }{%
    \bibstring[\emph]{andothers}%
    }
    \xpatchbibmacro{Name}{%
        \bibstring{name}
    }{%
    \bibstring[\textbf]{name}%
    }{}{} % leave these empty arguments here, seem to cause issues when ommited
    
% Kill "Accessed on" lines in bibliography
\AtEveryBibitem{
    \clearfield{urlyear}
    \clearfield{urlmonth}
    \clearfield{doi}
    \clearfield{url}
    \clearfield{eprint}
    \clearfield{eprinttype}
}


\begin{document}

\begin{titlepage}
    % Square brackets control size of vertical gap AFTER group
    %----------------------------------------------------------------------------------------
    %	LOGO SECTION
    %----------------------------------------------------------------------------------------
    
    \includegraphics[width=4cm]{./Images/logo.png}\\%[1cm] % Include a department/university logo - this will require the graphicx package
     
    %----------------------------------------------------------------------------------------
    
    \center % Center everything on the page
    
    
    %----------------------------------------------------------------------------------------
    %	TITLE SECTION
    %----------------------------------------------------------------------------------------
    \makeatletter
    \linespread{1.5} % controls line spacing of title
        {\huge{RECONCILING RESOURCE SUPPLY AND ONTOGENETIC GROWTH IN FISH}\par} % leave \par here
    \vspace{2.5cm} % Title of your document

    %----------------------------------------------------------------------------------------
    %	DESCRIPTION SECTION
    %----------------------------------------------------------------------------------------
    % If you want consistent line spacing then need to typeset paragraphy as a single {} group and use \\ for line break
    % Strangely, you need to leave the \ character at the end of the group so that the spacing of the last line from the penultimate line in a group remains constant
    % textsc command sets small capitals (sc)
    \textsc{A thesis submitted in partial fulfilment \\ of the requirements for the degree of \\ Master of Science at Imperial College London \\ by \\ \ }\\[2.5cm]
    \textsc{\Large \@author}\\[2.5cm]
    \textsc{Submitted for the \\ M.Sc. Computational Methods in Ecology \& Evolution \\ Formatted in the journal style of the Potato Journal \\ \ }\\[2cm]

    %----------------------------------------------------------------------------------------
    %	HEADING SECTIONS
    %----------------------------------------------------------------------------------------
    \textsc{Department of Life Sciences \\ Imperial College London \\ \ }\\[1cm]
    \textsc{\today}\\[2cm] % Date, change the \today to a set date if you want to be precise
    
    \vfill % Fill the rest of the page with whitespace
    
\end{titlepage}

%%% Declaration %%%
\section*{Declaration of Originality}\thispagestyle{empty}
    Declaration: The first page inside the cover must provide a brief declaration of the contributions
    made by you and by others to your project. Key points to address are:
    \begin{itemize}
        \item Was the data provided to you or did you collect or assemble it?
        \item Were you responsible for data processing or cleaning, if required?
        \item Were any mathematical models developed by you or by your supervisor?
        \item What role, if any, did your supervisor play in developing the analyses presented?
    \end{itemize}
    I certify that this thesis, and the research to which it refers, are the product of my own work, conducted during the current year of the \emph{M.Sc. Computational Methods in Ecology \& Evolution} at Imperial College London. Any ideas or quotations from the work of other people, published or otherwise, or from my own previous work are fully acknowledged in accordance with the standard referencing practices of the discipline and this institution.

    \textbf{Contributions:} Dr Samraat Pawar, Dr Diego Barneche, Dr Van Savage and Tom Clegg conceived the study. Diego Barneche compiled data on fish growth. S.P., T.C. and L.V. developed the idea.
    \vspace{3cm}
    \begin{flushright}
        Luke Joseph Vassor \\
        \today
    \end{flushright}

%%% Abstract %%%
\section*{Abstract}\thispagestyle{empty}
    Your abstract goes here. The abstract is a very brief summary of the dissertation's contents. It should be about half a page long. Somebody unfamiliar with your project should have a good idea of what it's about having read the abstract alone and will know whether it will be of interest to them.

\begin{jlcode}
    x = [1,2,3]
    y = [2,4,1]
    plot(x, y)
\end{jlcode}

%%% Acknowledgements %%%
\section*{Acknowledgements}\thispagestyle{empty}
    It is usual to thank those individuals who have provided particularly useful assistance, technical or otherwise, during your project. \\
    Samraat \\
    Dustin - useful conversations \\
    Tom - ditto \\
    Francis - code help \\
    Pawarlab - conversations and environment \\
    Alex - maths \\
    Course members \\

%%% Table of Contents %%%
\newpage\tableofcontents\thispagestyle{empty}

%%% List of Figures %%%
\newpage\listoffigures\thispagestyle{empty}
\addcontentsline{toc}{section}{List of Figures}

%%% Listof Tables %%%
\newpage\listoftables\thispagestyle{empty}
\addcontentsline{toc}{section}{List of Tables}

%%% Notation %%%
\newpage\section*{Notation}\thispagestyle{empty}
\addcontentsline{toc}{section}{Notation}   
    $\frac{dm}{dt}$ = change in mass with (continuous) time \\
    $m$ = mass \\
    $a$ = coefficient (proportion of body mass) for energy/resource intake/acquisition \\
    $b$ = coefficient for maintenance \\
    $c$ = coefficient for reproduction \\
    $y$ = mass scaling exponent for energy intake (almost always = 0.75 (MTE)) \\
    $z$ = mass scaling exponent for maintenance (almost always = 1) \\
    $\rho$ = mass scaling exponent for reproduction \\
    $\alpha$ = age at maturity (onset of reproduction) \\
    $m_{\alpha}$ = mass at maturity \\
    $M$ = asymptotic/terminal size \\
    $L(x)$ or $L_x$ = Probability of survival to age $x$ \\
    ATR = allocation to reproduction

%%% Introduction %%%
\newpage
\section{Introduction}\thispagestyle{empty}
    For over a century, biologists have attempted to understand ontogenetic growth - how an individual grows throughout its developmental lifetime, and why it does so. \textit{Why do organisms grow at the rate they do at certain points in their life? Why do they stop growing? What causes them to stop growing? Can they control growth? Why would they control growth? What is the optimal size to grow to? When is the optimal age to mature?} All valid and relevant questions which require a theoretical understanding of the constraints on growth and how evolution has selected for the patterns we observe given these constraints. These constraints dictate the variety of sizes, within and across species, and the fantastic spectrum of niches across the surface of the planet, since most key physiological, ecological and evolutionary life history parameters covary with body size \autocite{peters1983, brown2000-scaling-book,schmidt1984scaling,Marshall2019b}. To quote \cite{Bartholomew1981} ``It is only a slight overestimate to say that the most important attribute of an animal, both physiologically and ecologically, is its size''. At its most fundamental level, growth is a problem of resource allocation and strategy, attracting scientists from a range of biological disciplines including theorists, field ecologists and applied scientists, translating quantifiable, mathematisable and testable ideas derived from underlying generic principles and built into a predictive framework - a scientific theory \autocite{popper1962,popper1972,peters1983, West2011}. Mathematical biologists have attempted to capture growth in the form of sophisticated mathematical models, using laws from quantitative disciplines, such as the laws of geometry and laws of thermodynamics \& enzyme kinetics, to accurately predict the value of size over ontogeny. Geometric scaling laws have become of particular interest to those who seek to model growth and develop equations which relate an organism's characteristics to its body size, since many biological traits scale with body size, governed by a power law. These take the form of:
        \begin{equation*}
            Y = Y_0 M^{\beta}
        \end{equation*}
    where $Y$ is the biological characteristic to be predicted, $M$ is body mass, and $Y_0$ and $\beta$ are empirically derived constants. These are formalised into ``allometric" equations. If $\beta = 1$, the scaling is said to be ``isometric", while if $\beta \neq 1$, the relationship is called allometric, and plots as a curve on linear axes \autocite{brown2000-scaling-book}.

    The modelling approaches used to understand the problem of ontogenetic growth have historically bifurcated into two major branches. Evolutionary Life History Theory relates growth, phenomenologically, to fundamental life history events, given that animals typically have to reach a certain size in order to progress ontogenetically. The Metabolic Theory of Ecology relates growth, mechanistically, to fundamental cellular and energetic processes which constrain the scope for growth.
        
    Evolutionary life history and game theorists, concerned with growth from a coarser-level, life history perspective, have typically employed optimisation techniques to solve for the optimal age and size values of given life history events, for example age-at-maturation, which maximise lifetime reproductive output. The \textit{modus operandi} is to assume that evolution maximises this quantity, and that strategies concerning the timing of life-history events are the product of evolution optimising trade-offs among competing traits \autocite{Day1997, Stearns1989, stearns1992evolution}. As such, life-history theory typically makes simplifying assumptions with regard to mechanisms \autocite{Day1997, Kozowski1987-indeterminate}. For instance, those which cause energy distribution and metabolism to scale with body size \autocite{peters1983,Werner1988,West1997,brown2000-scaling-book}. Models, and their parameters, are driven by selection on body size, and the underlying physiology is thought to evolve in response to those selection pressures - the external context is the focus. To this end, size-at-maturity is predicted to be inversely related to mortality rate under a simple life-history model \autocite{stearns1992evolution}.
        
    Converseley, metabolic theorists, concerned with growth at a finer level, utilise laws from thermodynamics and enzyme kinetics as a first-principles approach to growth problems, combining biological knowledge, intuition and mathematics to explain observed ecological phenomena \autocite{Brown2004}. Paradigmatically, everything an organism does in its lifetime, including how it grows, is governed by the metabolic energy that flows into its system and how it is distributed and transformed. The chain of causality in the scientific approaches of Metabolic Theory and Life History Theory are the inverse of one another. Life History Theory asks: ``given that these mechanisms exist and scale, what is the predicted optimum strategy?'' whereas Metabiolic Theory asks: ``given that these strategies have evolved to be optimal, what are the energetic mechanisms that explain them?''. These models are derived from an energy-balance framework, originally developed by \cite{Putter1920} and now associated with the von Bertalanffy growth function (VGBF) \autocite{vonBert1938, VonBertalanffy1957}. The central idea is that an organism garners energy from its environment at a certain rate, which it then expends on some internal maintenance process(es) at a certain rate, thus ``losing'' energy which it could use for growing. Any surplus energy remaining after this expenditure, can then be used to synthesise new biomass for growth.  Therefore, mechanistic growth models seek to estimate an energy ``profit'', i.e. costs (maintenance) deducted from revenue (intake or consumption). As an organism grows larger, its expenditure on maintenance scales with mass to a larger exponent than energy intake (subject to different power laws), hence as it grows larger, energy profit decreases and growth rate slows. Whilst extant models agree upon a mass exponent of 1 for maintenance rate (double the body mass = double the number of cells), the mass exponent of intake rate has been debated through time, given its derivation from different geometric mechanisms. The VGBF proposed a value of $2/3$, which \cite{vonBert1938} argued to be because intake covaries with metabolic rate, which is governed by absorbtion across a membrane surface (rearrangement of $\pi r^2$), whereas West \textit{et al.} have since argued a value of $3/4$, due to transport via a fractal-like supply network (e.g. capillaries). 
    \begin{equation}
        \frac{dm}{dt} = am^{3/4} - bm \label{west_ogm}
    \end{equation}
    Since power laws have the convenient property of the exponent being equal to the slope on logarithmic axes, $\log{(am^y)} = y\cdot \log{(am)}$, these scalings can be understood more intuitively plotted in \cref{growth_schedules}. For determinate growers, these values reach equivalence at an asymptotic mass, when the individual is ``spending'' energy via metabolism as quickly as it can acquire it, thus leaving no surplus for growth.
    \begin{center}
        \begin{minipage}{0.48\linewidth}
        \includegraphics[width=0.49\linewidth]{../Other/Presentation/determinate.pdf}
        \label{growth_schedules}
        \includegraphics[width=0.49\linewidth]{../Other/Presentation/indeterminate.pdf}  
        % \label{indeterminate}
        \captionof{figure}{Determinate growth evolves from having energy intake and maintenance rates which eventually intercept. Indeterminate growers do have a theoretical asymptotic size, due to the finite nature of energy resource, but this is never reached.}
        \end{minipage}%
        \hfill
        \begin{minipage}{0.45\linewidth}
            \includegraphics[width=\linewidth]{../Other/Presentation/logistic_growth_curve.pdf}  
            \label{logistic_growth}
            \captionof{figure}{Logistic Growth. Determinate growers reach asymptotic size before death, where indeterminate do not, hence they appear to grow indefinitely.}
        \end{minipage}
    \end{center}
    Whilst these two branches of theory tend to operate in isolation, several attempts have been made at combining them. To reconcile the two theories, authors have typically used seperate, energetically-derived (mechanistic) growth equations for different ontogenetic stages, e.g. juvenile and mature, to form two-piece or ``biphasic'' models (reviewed in \cite{Wilson2018})Post-maturity equations usually introduce a new energy loss term representing rate of energy allocate to reproduction. These hybrids maximise explanatory potential by blending both philosophies to gain a proximate and ultimate understanding of growth \autocite{Marshall2019b}.    

    Intriguingly, despite being an uncontroversially fundamental life history event, the VBGF, and the majority of models which have evolved from it that simply consider intake and maintenance, such as \cite{West2001}, appear, at least explicitly, to be agnostic to reproduction. It was indicated over 20 years ago that mechanistic inferences made from the results of these models are problematic since they do not account for reproduction \autocite{Day1997, Marshall2019b}. Reproduction incurs large energetic costs and increases an organism's mortality risk, with some highly fecund vertebrates consisting of 75\% reproductive tissue \autocite{Parker2018}. At the onset of reproduction, different mechanistic dynamics emerge relative to those in the preceding juvenile phase as energetic resources are shunted from growth to reproduction \autocite{Day1997}. Explicit account of reproduction in ontogenetic growth models has recently gained even greater attention since the results of a new, large meta-study across 324 species of fish were published, which concluded that total fish fecundity, considering clutch size, egg volume and egg energy content, scales hyperallometrically with mass (mean scaling exponent = 1.29; 95\% CI 1.20 to 1.38) \autocite{Barneche2018d}. In a consequent review of the OGM literature, \cite{Marshall2019b} claim that these results reset theoretical assumptions of growth models and have profound fisheries implications, given that quotas are estimated using spawning potential metrics calculated from these types of model. However, such a grand claim may be premature in its making, since the data analysed by \cite{Barneche2018d} represent batch fecundity at discrete time points, a consequence of the typical sampling technique used to measure gonad properties, involving catch and dissection. These discrete data are not compatible with the continuous rates that growth models are built on (see SI), so, consequently, allocation of energy to reproduction in continuous time, of which data are difficult to obtain, may not, in fact, scale hyperallometrically with mass. In fact, when a simple growth model with an added term representing this hyperallometry is simulated, a large parameter space (larger mass-at-maturtiy and reproduction scaling exponents), produced shrinking growth trajectories. Since fish do not shed somatic mass over ontogeny, this may be indicative of false approximation of the magnitude of reproduction allocation rate with non-rate data.
    
    Secondly, extant models also fail to consider variable, or environment-dependent, scaling of energy intake rate. Many assume a simple relationship between consumption rate (energy acquisition) and resting metabolic rate, which erroneously in assumes that per-capita consumption rate scales with consumer body size ($m$) to an exponent of $3/4$ (see above), irrespective of taxon or environment \autocite{Pawar2012}. Deviations from this scaling can arise because foraging is constrained by traits which do not scale with metabolic rate (e.g. locomotory appendages) and because metabolic rates are usually measured under idealised, often laboratory, conditions. Those stipulated are no foraging (food is provided \textit{ad libitum}), growing or reproducing. These are not representative of a natural setting and, as such, consumption-rate may scale instead with field or maximal metabolic rate (exponent $\geq$ 0.85) \autocite{peters1983,Weibel2004, Pawar2012}. For 3-D foraging organisms, such as pelagic fish, exponent can reach 1.06, in a resorurce-depleted environment. By using the scaling of resting metabolic rate, models implicitly assume the idealised conditions of RMR measurements and may underestimate the intake rate given the lower mass exponent.
    
    Both of these findings reveal gaps in the fish ontogenetic growth modelling literature, begging the following questions:
    \begin{enumerate}
        \item Does the continuous rate of allocation of energetic resources to reproduction in fish mothers scale hyperallometrically with body mass? i.e. Are larger mothers disporportionately more fecund?
        \item Are we underestimating the scope for growth by assuming that intake rate scales with resting metabolic rate?
    \end{enumerate}
    In this paper I answer these questions using ecological theory by simulating ontogenetic growth curves parameterised with a range of fecundity values from a bivariate distriubtion. Answering question 1. is crucial in assessing the validity of the claim that reproductive allocation rate scales hyperallometrically with mass, quantifying and endorsing the distinction between continuous rate data and discrete time data. I do this my optimising fecundity parameter values for maximum reproduction. Answering question 2. will be integral to highlighting the theoretical assumptions of extant models, with the potential to warrant update to the $3/4$ mass-scaling of intake rate. Furthermore, bridging these questions will also provide insight into the validity of the reproductive hyperallometry claim, since the reason we do not observe shrinking trajectories in reality may be because larger intake rate scaling permits larger scaling exponents of fecundity. Quantifying the effects of these new findings for fish growth models will have profound implications for fisheries management and for growth modelling as a scientific practice in general.

%%% Methods %%%
\section{The Model}\thispagestyle{empty}
I tested the validity of the claim that fecundity in fish scales hyperallometrically with mass using a biphasic, hybrid model which utilises Ecological Metabolic Theory and Life History Theory. Developed from \cite{Charnov2001}, who attempted to solve for optimum life history values by extending the \cite{West2001} framework, until maturity (age $\alpha$, size $m_{\alpha}$), fish incur costs only from maintenance as they are sexually immature, captured by the \cite{West2001} equation. At $\alpha$, a reproduction term is introduced where c is the proportion of body mass allocated to reproduction and $\rho$ is how reproduction scales with mass.
\begin{align}
    \frac{dm}{dt} &= am^{3/4} - bm \ \ \ \ \ \ \ \ \ \ \ \ \ \ m < m_{\alpha} \nonumber \\
    \frac{dm}{dt} &= am^{3/4} - bm - cm^{\rho} \ \ \ \ \ m \geq m_{\alpha} \label{luke_model}
\end{align}
At this point my model crucially differs from Charnov, who considered $\rho = 1$ (isometric mass-scaling), which is mathematically equivalent to elevating maintenance cost, since the maintenance and reproduction term have equivalent mass-scaling exponents:
\begin{align*}
    \frac{dm}{dt} &= am^{3/4} - bm - cm \\
    \frac{dm}{dt} &= am^{3/4} - (b+c)m
\end{align*}
Equally, models which do not explicity consider reproduction (only maintenance $-bm$) make the same assumption implicitly, since modelling across ontogeny assumes that organisms progress to maturity, which incurs an energetic cost, simply reflected in higher maintenance cost. This again assumes isometric mass-scaling of reproduction allocation rate. \cite{Marshall2019b}, in a recent review of OGMs, took particular issue with this assumption, given the results published by \cite{Barneche2018d}. Specifically, they take a philosophical stand by fitting a model identical to \cref{luke_model} to fish age-at-size data, which fits as well as the \cite{west2001} and \cite{vonBert1938} models (although they argue this by curve-overlap rather than using a valid model comparison metric such as Akaike or Baysian Information Criterion.) However, upon deriving the units of the quantities in this equation, it becomes apparent that the \cite{Marshall2019b} model is problematic in that it inadvertently reconciles two incompatible quantities. The units of all terms in the OGM are in \textsc{mass/time} in continuous time (see SI for full derivation and unit explanation). However, the (acclaimed hyperallometric) fecundity data reported by \cite{Barneche2018d} were for discrete, batch spawning events, where the typical method of data collection is to catch and dissect a fish and take gonadal measurements at that point in time (Barneche, 2019, pers comm). Collecting this data for different sized fish of the same species is not mathematically equivalent to a continuous rate of allocation of resources to reproduction which could then be used for a continuous growth rate measure. To this end, \cite{Marshall2019b} are inferring continuous rate scaling from discrete time data, and, as such, may be premature in their claims.    

The $3/4$ scaling of intake rate is derived from the fractal architecture of space-filling, hierarchical branching supply networks (e.g. capillaries) whose geometry has evolved due to natural selection optimising energy transport \autocite{West1997, West2005}. The self-similarity of the network at decreasing levels approximates a fractal, which is mathematically considered to have a non-integer dimension \autocite{Hausdorff1918, Mandelbrot1982}. Energy intake scales to the $3/4$ exponent of mass due to the scaling of the number of terminal units, e.g. capillaries, in the network with size. That is, bigger entities do not evolve bigger networks, but the networks become more deeply nested with child branches \autocite{West1997}. This is the reasoning behind the famous Kleiber's law that, for the vast majority of animals, resting metabolic rate scales hypoallometrically to the $3/4$ power of the animal's mass \autocite{Kleiber1947, peters1983, niklas1994plant}.

The model is based on the LHT concept that assumes that natural selection optimises strategies, e.g. $c$ and $\rho$, to maximise fitness, where lifetime reproductive output can be used as a proxy for fitness, denoted $R_0$, which can be derived from theoretical evolution studies \autocite{Charnov2001, stearns1992evolution}. To this end, the model was analysed via simulations which allowed the fecundity rate parameters $c$ and $\rho$ to vary in order to maximise $R_0$, which is calculated using a life history model, developed from \cite{Charnov2001}. Since the scope for reproduction is determined by how much energy is available, it follows that the optimal values of $c$ and $\rho$ are dependent on the value and scaling of intake rate $am^{x}$. 

At any time $t$, $b_{t}$ is the \textit{effective} energy allocated by fish to reproduction, the product of the physiological allocation of resources $cm^{\rho}$ and an efficiency term $h(m)$ representing a declining efficiency of this allocation, known as reproductive senescence, the natural decline in fecundity as fish age \autocite{Stearns2000, Benoit2018, Vrtilek2018}. This decline begins at maturity ($\alpha$) and is controlled by a rate parameter $\kappa$. Fish also experience an extrinsic mortality rate, or actuarial senescence, contained in a surivorship function, $l_t$, which is effectively a declining $\mathbb{P}$(survival to t) \autocite{Peterson1984, Charnov1993, Charnov2001, Benoit2018, Laird2010, Reznick2002, Reznick2006}. Thus, the instanteous reproductive output at time $t$ is the product $l_{t}b_{t}$ and the lifetime reproductive output is:
\begin{equation}
    R_{0} = \int_{\alpha}^{\infty}l_{t}b_{t} dt
\end{equation}
Since fish live in a juvenile and adult phase, they are subject to varying mortality rates through ontogeny \autocite{Charnov2001}. Juvenile mortality ($t_0 \rightarrow t_{\alpha}$) controls how many fish are recruited into the adult phase and, since it follows an exponential distribution, $l_t = e^{-\int_{0}^{\alpha}Z(t)dt}$ bounded [0,1] it thus acts as a scaling factor, denoted $L_{\alpha}$, for the mature population ($t_{\alpha} \rightarrow t_{\infty}$). For adults survival is \textbf{relative to when maturity is reached}, $l_{t} = e^{-Z(t-\alpha)}$:
\begin{equation}
    R_{0} = c\int_{0}^{\alpha}e^{-Z(t)}dt\int_{\alpha}^{\infty} m(t)^{\rho} e^{-(\kappa+Z)(t-\alpha)} dt \label{LHT_optimisation}
\end{equation}
A common utility in comparative life histories in fish is the invariance of dimensionless quantities derived from the timing of LH events. That is, across species within a taxon, certain life history variables, representing the timing and magnitude of reproduction form, dimensionless, invariant ratios \autocite{Charnov1993}. It has been shown for fish that the ratio of age-at-maturity and mortality rate, $\alpha\cdot Z \approx 2$ \autocite{Charnov1993}. As such, I employed a rearrangement of this to calculate mortality rate for a given $\alpha$ value.
See SI for full derivation.

To perform this optimisation, the analytical goal would be to solve \cref{LHT_optimisation} for values of $c$ and $\rho$ which maximise $R_0$. Since it has no closed-form solution, I simulated this numerically using the \texttt{DifferentialEquations} and \texttt{DiffEqCallbacks} packages in Julia v1.1.1 \autocite{Bezanson2017}, which ran the Rosenbrock optimisation function \autocite{Rosenbrock1960}. The following parameter space was simulated $0.001 < c < 0.4$ and $0.001 < \rho < 1.25$ with 100 linearly-spaced values over a lifespan of $1e6$ days, to ensure all growth trajectory simulations reached asymptotic size.


Incoming rate of energy, $B$, scales with standard metabolic rate, such that $B = B_{0}m^{3/4}$, where $B_0$ is constant for a given taxon. Thus we get
\begin{equation}
    \frac{dm}{dt} = am^{3/4} - bm
\end{equation}
where $a \equiv B_{0}m_{c}/E_{c}$ and $b \equiv B_{c}/E_{c}$. \cite{West2001} claim that: ``Perhaps more significantly, the magnitudes of $a$ and $b$ can be independently determined from fundamental parameters of the cell:'' 
\begin{itemize}
    \item The energy content of mammalian tissue $E_T$
    \item Mass of a single cell $m_c$
    \item Energy needed to create a cell \textit{in vivo} $E_c$
    \item Metabolic rate intercept $B_0$
\end{itemize} 
\begin{align*}
    E_T &\approx 7 \cdot 10^6 JKg^{-1} \\
    m_c &\approx 3 \cdot 10^{-9} g \\
    E_c &= E_T \cdot m_c \\
    E_c &= (7 \cdot 10^6 JKg^{-1})(3 \cdot 10^{-12} Kg) \\
    E_c &\approx 2.1 \cdot 10^{-5} J \\
    B_0 &\approx 1.9 \cdot 10^{-2} W \\
    a &\equiv B_{0}m_{c}/E_{c} \\
    a &= \frac{(1.9 \cdot 10^{-2} W)(3 \cdot 10^{-9} g)}{2.1 \cdot 10^{-5} J}\\
    a &\approx 0.25 g^{1/4}day^{-1}
\end{align*}
\newpage
They claim this is in ``good agreement'' with the data in their Table 1 (below), but upon observation, it is only in good agreement for mammals, which makes sense since they used the energy content of mammalian tissue taken from \cite{peters1983}. However, upon further investigation, it became apparent that they had taken their value for $B_0$ for unicellular organnisms, derived from data published by \cite{Hemmingsen1960} which included different slope (scaling) values for unicellulars, poikilotherms and homeotherms (see Fig 5).

\begin{table}[h]
    \caption{Parameter values for model fitting from \cite{West2001}}
    \begin{center}
    \begin{tabular}{|l|l|l|l|l|}
    \hline
    Organism            & $a$   & $m_0$   & $M$     & Slope \\ \hline
    Cow                 & 0.28  & 33.3 kg & 442kg   & 1.08  \\ \hline
    Pig                 & 0.31  & 0.90 kg & 320kg   & 1.08  \\ \hline
    Rabbit              & 0.36  & 0.12 kg & 1.35 kg & 1.34  \\ \hline
    Guinea pig          & 0.21  & 5 g     & 840g    & 0.91  \\ \hline
    Rat                 & 0.23  & 8 g     & 280g    & 1.07  \\ \hline
    Shrew               & 0.83  & 0.3 g   & 4.2 g   & 0.98  \\ \hline
    Heron               & 1.56  & 3 g     & 2.7 kg  & 1.04  \\ \hline
    Hen                 & 0.47  & 43g     & 2.1 kg  & 0.72  \\ \hline
    Robin               & 1.9   & 1 g     & 22g     & 1.03  \\ \hline
    Cod                 & 0.017 & 0.1 g   & 25 kg   & 1.01  \\ \hline
    Salmon              & 0.026 & 0.01 g  & 2.4 kg  & 1.01  \\ \hline
    Guppy               & 0.10  & 0.008 g & 0.15 g  & 1.04  \\ \hline
    Shrimp              & 0.027 & 0.0008g & 0.075g  & 0.82  \\ \hline
    \end{tabular}
    \end{center}
\end{table}
\begin{center}
    \begin{minipage}{0.6\linewidth}
        \includegraphics[width=\linewidth]{../Data/hemmingsen_1960.jpg}
        \captionof{figure}{Plot published by \cite{Hemmingsen1960}}
    \end{minipage}
\end{center}

Since my model is capturing the growth of fish, we can adapt their framework using  accurate fish values for the same cellular parameters. Furthermore, I can see if theoretical calculations predict \cite{West2001}'s $a$ for fish. Energy content caloric equivalents for fish tissue were calculated as average from caloric equivalent values across 70 fish species, converted from $kJ\cdot g^{-1}$ to $JKg^{-1}$ using ``per gram of wet weight'' values \autocite{Steimle1980} (\cite{West2001} also used wet weight). Standard metabolic rate values derived by \cite{Hemmingsen1960} from Figure 5 are:
\begin{itemize}
    \item $MR = 4.1m^{0.751}$ (homeotherms)
    \item $MR = 0.14m^{0.751}$ (poikilotherms)
    \item $MR = 0.018m^{0.751}$ (unicellular) [used by \cite{West2001} for all animals]
\end{itemize}

We want to end up with $g\cdot day^{-1}$ so convert masses to $g$ first:
\begin{align*}
    E_T &= 5.6348018286 \cdot 10^3 J\cdot g^{-1} \\
    m_c &\approx 3 \cdot 10^{-9} g \\
    E_c &= E_T \cdot m_c \\
    E_c &= (5.635 \cdot 10^3 J\cdot g^{-1})(3 \cdot 10^{-9} g) \\
    E_c &= 1.69 \cdot 10^{-5} J \\
    B_0 &\approx 1.4 \cdot 10^{-1} W \\
    a &\equiv B_{0}m_{c}/E_{c} \\
    a &= \frac{(1.4 \cdot 10^{-1} W)(3 \cdot 10^{-9} g)}{1.69 \cdot 10^{-5} J}\\
    a &= 2.4867 \cdot 10^{-5}g\cdot s^{-1} \\
    2.4867 \cdot 10^{-5}&g\cdot s^{-1} \cdot 24 \cdot 60 \cdot 60 \ \ \textsc{   seconds to days}\\
    a &= 2.1485 g^{1/4}\cdot day^{-1}
\end{align*}

%%% Results %%%
\section{Results}\thispagestyle{empty}
\cref{growth_curve} is demonstrative of the shunting of resources to reproduction when a fish becomes mature.
\begin{center}
    \begin{minipage}{0.7\linewidth}
        \includegraphics[width=\linewidth]{../Results/single_curve_with_onset.pdf}
        \captionof{figure}{Example growth curve showing an inflection at the onset of reproduction, $\alpha = 200$}
        \label{growth_curve}
    \end{minipage}\\
    \begin{minipage}{0.5\linewidth}
    \includegraphics[width=\linewidth]{{../Results/opt_hm_Alph=200.00_a=0.70_x=0.75_k=0.01}.pdf}
    \captionof{figure}{$am^x = (0.7)m^{0.75}, \kappa = 0.01$}
    \end{minipage}%
    % \hfill
    \begin{minipage}{0.5\linewidth}
    \includegraphics[width=\linewidth]{{../Results/opt_hm_Alph=200.00_a=0.70_x=0.75_k=0.10}.pdf}  
    \captionof{figure}{$am^x = (0.7)m^{0.75}, \kappa = 0.10$}
    \end{minipage}\\
    \begin{minipage}{0.5\linewidth}
        \includegraphics[width=\linewidth]{{../Results/opt_hm_Alph=200.00_a=0.70_x=0.85_k=0.01}.pdf}  
        \captionof{figure}{$am^x = (0.7)m^{0.85}, \kappa = 0.01$}
    \end{minipage}%
    % \hfill
    \begin{minipage}{0.5\linewidth}
        \includegraphics[width=\linewidth]{{../Results/opt_hm_Alph=200.00_a=0.70_x=0.85_k=0.10}.pdf}    
        \captionof{figure}{$am^x = (0.7)m^{0.85}, \kappa = 0.10$}
    \end{minipage}
\end{center}
As is apparent from Figure 7-10, optimisation is insensitive to $\kappa$
\textcolor{red}{A minority have attempted the same concept via the use of a discontinuous step function.}


%%% Discussion %%%
\section{Discussion}\thispagestyle{empty}
\lipsum

%%% Conclusion %%%
\section{Conclusion}\thispagestyle{empty}
\lipsum

%%% Bibliography %%%
\addcontentsline{toc}{section}{Bibliography}
\newpage\let\mkbibnamefamily\textsc\printbibliography[title=Bibliography]\thispagestyle{empty} % Sets author names to small caps

%%% SI %%%
\addcontentsline{toc}{section}{Supplementary Information}
% \includepdf[pages=-]{Vassor_L_J_CMEE_Thesis_2019_Supplementary_Information.pdf}

\end{document}