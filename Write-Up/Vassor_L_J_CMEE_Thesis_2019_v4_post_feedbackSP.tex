\documentclass[a4paper]{article} % twoside for paper submission but remove for electronic submission
\title{Reconciling Resource Supply and Ontogenetic Growth (Models)}
\author{Luke Joseph Vassor}

%%%% Packages %%%

% Page Formatting packages
\usepackage[margin=2cm]{geometry}
\usepackage{lipsum} % Generates dummy text
\usepackage{titlesec}
    \titleformat*{\section}{\LARGE\bfseries}
    \titleformat*{\subsection}{\Large\bfseries}
    \titleformat*{\subsubsection}{\large\bfseries}
    \titleformat*{\paragraph}{\large\bfseries}
    \titleformat*{\subparagraph}{\large\bfseries}
    \newcommand{\sectionbreak}{\newpage} % forces new page for each section
    \titlespacing*{\section}
{0pt}{20cm plus 1ex minus .2ex}{4.3ex plus .2ex}
\usepackage{etoolbox}

\makeatletter
\patchcmd{\ttlh@hang}{\parindent\z@}{\parindent\z@\leavevmode}{}{}
\patchcmd{\ttlh@hang}{\noindent}{}{}{}
\makeatother
\usepackage{fancyhdr} % rule line and current section displayed at top of pages % \thispagestyle{plain} removes it on desired pages
    \pagestyle{fancy}
    \renewcommand{\footrulewidth}{0.4pt}% default is 0pt
    \renewcommand{\headrulewidth}{0.4pt}% default is 0pt
    \renewcommand{\sectionmark}[1]{\markboth{#1}{}} % set the \leftmark to section name
    \fancyhead[L]{\nouppercase{\leftmark}} %  sets the left head element ONLY EVER section name, otherwise mark is section/subsection/subsubsection
    \fancyhead[R]{} % sets the right head element to the page number if you use \thepage as argument
    \fancyfoot[C]{\thepage} % sets footer as page number

\usepackage{pdfpages}
% \usepackage{lscape}
% Math packages
\usepackage{amsmath}
\usepackage{amssymb}
% \usepackage{mathpazo}
\usepackage{xpatch}

% Language packages
% \usepackage[english]{babel}
\usepackage[utf8]{inputenc}    % utf8 support       %!!!!!!!!!!!!!!!!!!!!
\usepackage[T1]{fontenc}       % code for pdf file  %!!!!!!!!!!!!!!!!!!!!
% \usepackage{listings}

% Other packages
\usepackage{lmodern}% http://ctan.org/pkg/lmodern
\usepackage{slantsc}
\usepackage{xcolor}
\usepackage{parskip}
\usepackage{tocloft}
    \renewcommand{\cftsecleader}{\cftdotfill{\cftdotsep}} % for sections
% \usepackage[colorinlistoftodos]{todonotes}

% Plotting packages
\makeatletter
\newcommand{\thickhline}{%      % for thick lines in table
    \noalign {\ifnum 0=`}\fi \hrule height 1pt
    \futurelet \reserved@a \@xhline
}
% \usepackage{subfigure}
\usepackage[pyplot]{juliaplots}
\usepackage{wrapfig}
\usepackage{graphicx}
\usepackage[font=small,labelfont=bf]{caption} % Required for specifying captions to tables and figures
\usepackage{tabularx}
% Citation packages
\usepackage[maxcitenames=2, backend=biber, dashed=false, style=imperialharvard]{biblatex}
    \addbibresource{./CMEE_Thesis.bib}
    \setlength\bibitemsep{0.5\baselineskip}
    % \renewcommand*\finalnamedelim{\addspace\&\space}

% Force \textit{et al}. to be italicised

    \xpatchbibmacro{name:andothers}{%
        \bibstring{andothers}%
    }{%
    \bibstring[\emph]{andothers}%
    }
    \xpatchbibmacro{Name}{%
        \bibstring{name}
    }{%
    \bibstring[\textbf]{name}%
    }{}{} % leave these empty arguments here, seem to cause issues when ommited
    
% Kill "Accessed on" lines in bibliography
\AtEveryBibitem{
    \clearfield{urlyear}
    \clearfield{urlmonth}
    \clearfield{doi}
    \clearfield{url}
    \clearfield{eprint}
    \clearfield{eprinttype}
}
\usepackage[capitalise]{cleveref}

\begin{document}

\begin{titlepage}
    % Square brackets control size of vertical gap AFTER group
    %----------------------------------------------------------------------------------------
    %	LOGO SECTION
    %----------------------------------------------------------------------------------------
    
    \includegraphics[width=4cm]{./Images/logo.png}\\%[1cm] % Include a department/university logo - this will require the graphicx package
     
    %----------------------------------------------------------------------------------------
    
    \center % Center everything on the page
    
    
    %----------------------------------------------------------------------------------------
    %	TITLE SECTION
    %----------------------------------------------------------------------------------------
    \makeatletter
    \linespread{1.5} % controls line spacing of title
        {\huge{RECONCILING RESOURCE SUPPLY AND ONTOGENETIC GROWTH IN FISH}\par} % leave \par here
    \vspace{2.5cm} % Title of your document

    %----------------------------------------------------------------------------------------
    %	DESCRIPTION SECTION
    %----------------------------------------------------------------------------------------
    % If you want consistent line spacing then need to typeset paragraphy as a single {} group and use \\ for line break
    % Strangely, you need to leave the \ character at the end of the group so that the spacing of the last line from the penultimate line in a group remains constant
    % textsc command sets small capitals (sc)
    \textsc{A thesis submitted in partial fulfilment \\ of the requirements for the degree of \\ Master of Science at Imperial College London \\ by \\ \ }\\[2.5cm]
    \textsc{\Large \@author}\\[2.5cm]
    \textsc{Submitted for the \\ M.Sc. Computational Methods in Ecology \& Evolution \\ Formatted in the journal style of \textsl{\textsc{Ecology Letters}} \\ \ }\\[2cm]

    %----------------------------------------------------------------------------------------
    %	HEADING SECTIONS
    %----------------------------------------------------------------------------------------
    \textsc{Department of Life Sciences \\ Imperial College London \\ \ }\\[1cm]
    \textsc{\today}\\[2cm] % Date, change the \today to a set date if you want to be precise
    
    \vfill % Fill the rest of the page with whitespace
    
\end{titlepage}

%%% Declaration %%%
\section*{Declaration of Originality}\thispagestyle{plain}
    Declaration: The first page inside the cover must provide a brief declaration of the contributions
    made by you and by others to your project. Key points to address are:
    \begin{itemize}
        \item Was the data provided to you or did you collect or assemble it?
        \item Were you responsible for data processing or cleaning, if required?
        \item Were any mathematical models developed by you or by your supervisor?
        \item What role, if any, did your supervisor play in developing the analyses presented?
    \end{itemize}
    I certify that this thesis, and the research to which it refers, are the product of my own work, conducted during the current year of the \emph{M.Sc. Computational Methods in Ecology \& Evolution} at Imperial College London. Any ideas or quotations from the work of other people, published or otherwise, or from my own previous work are fully acknowledged in accordance with the standard referencing practices of the discipline and this institution.

    \textbf{Contributions:} Dr Samraat Pawar, Dr Diego Barneche, Dr Van Savage and Tom Clegg conceived the study. Diego Barneche compiled data on fish growth. S.P., T.C. and L.V. developed the idea.
    \vspace{3cm}
    \begin{flushright}
        Luke Joseph Vassor \\
        \today
    \end{flushright}

%%% Abstract %%%
\section*{Abstract}\thispagestyle{plain}
    The amount of metabolic energy an organism can sequester from its environment fundamentally determines its scope for growth and reproduction. Here I use an energetics and life history theoretical model to estimate the optimum mass-proportion and mass-scaling values of fecundity rate in fish, under different energy intake regimes, to test a recent claim that it scales hyperallometrically with mass. Theoretically, I show that a truly continuous rate of allocation to fecundity cannot scale hyperallometrically with size. I also derive and validate the use of a new intake rate value, based on fish energetics data and field metabolic rate mass-scaling, by demonstrating that the onset of reproductive allocation at maturity is only possible given these intake rate values. Overall, the study highlights the importance of correctly characterising growth and the fitness contribution of different sized individuals to a population.

    \textbf{Keywords} \\
    Biomass; energetics; productivity; allometry; life history; fisheries
%%% Acknowledgements %%%
\section*{Acknowledgements}\thispagestyle{plain}
    Special thanks goes to Dr Samraat Pawar for providing excellent supervision and facilitating  highly-stimulating, always comical, dialogue throughout the 5-month thesis period, and the CMEE course in general. Likewise to Tom Clegg, for his part in this, and his unwavering patience in providing frequent additional support and discussion outside of scheduled meetings. Additional thanks goes to Dr Diego Barneche, Prof Van Savage and Prof Dustin Marshall for allocating time to this problem on their visits to Silwood Park, to Francis Windram and Alex Christensen for coding and mathematics assistance, respectively, to Deraj Wilson-Aggarwal for moral support and Barista skills, and to the remaining members of PawarLab for providing such an open, intellectual and hilarious environment. Lastly, the completion of this thesis, or the degree in general, would not have been possible without the efforts and support of my family, who have assisted in any way possible to make life easier, be that via food or transport, I will always be grateful to them. Nor would it have been possible without the support of my partner, Tiffany, who, despite her passion for a different field, has tolerated my endless utterances and vocalised mental grapplings with metabolic, life history and game theory for the last 5 months - something tells me I should hold on tight.

%%% Table of Contents %%%
\newpage\tableofcontents\thispagestyle{plain}

%%% List of Figures %%%
\newpage\listoffigures\thispagestyle{plain}
\addcontentsline{toc}{section}{List of Figures}

%%% Listof Tables %%%
% \newpage\listoftables\thispagestyle{plain}
% \addcontentsline{toc}{section}{List of Tables}

%%% Notation %%%
\newpage\section*{Notation}\thispagestyle{plain}
\addcontentsline{toc}{section}{Notation}   
\begin{table}[h]
    % \caption{Parameterisations for the scaling relationships underlying the growth model. All units are in SI.}
    \begin{tabularx}{\linewidth}{ll}
    \thickhline
    \textbf{Description}                        & \textbf{Symbol}       \\ \thickhline
    Change in body mass with (continuous) time  & $\frac{dm}{dt}$       \\
    Body mass                                   & $m$                   \\ \hline
    Energy Intake/Acquisition Rate              & $a$                   \\ 
                                                & $y$                   \\ \hline
    Maintenance Metabolic Rate                  & $b$                   \\ 
                                                & $z$                   \\ \hline
    Allocation to reproduction Rate             & $c$                   \\  %\autocite{peters1983,Blueweiss1978}
    (estimated by GSI*)                         & $\rho$                \\ \hline %$1.29$ \autocite{Barneche2018d}
    ATR = allocation to reproduction            & ATR                   \\ \hline
    Age at maturity (onset of reproduction)     & $\alpha$              \\ \hline
    Consumption rate                            & $C(t)$                \\ \hline
                                                & $\gamma$              \\ \hline
    Foraging length                             & $t_0$                 \\
                                                & $\psi$                \\ \hline
    Mass at maturity                            & $m_{\alpha}$          \\ \hline
    Asymptotic/terminal size                    & $M$ or $m_{\infty}$   \\ \hline
    Probability of survival to time $t$         & $L_t$                 \\ \hline
    Rate of instantaneous mortality             & $Z$                   \\ \thickhline
    \end{tabularx}
\end{table}
*Gonadosomatic Index; proportion of somatic body mass given to repro per year

%%% Introduction %%%
\newpage
\section{Introduction}\thispagestyle{plain}
    Organisms must grow by synthesising biomass from consumed resources in order to progress through ontogeny, or biologically distinct stages of life. The rate of biomass production directly influences fitness at the individual level by constraining the speed at which maturity is reached and beyond the individual, has scalable, measurable impacts at multiple ecological levels. Biologists sought to gain a proximate and ultimate understanding ontogenetic growth for over a century. \textit{Why do organisms grow at a specific rate during a specific stage of development? Why do they stop growing? What causes them to stop growing? Can growth be controlled, and if so, why? What is the optimal size to grow to? When is the optimal age to mature?} These are all valid and relevant questions, answers to which require a theoretical understanding of the energetics of growth and how evolution has selected for the patterns we observe given these constraints. Energetic constraints dictate the variety of sizes and, consequently, the fantastic spectrum of niches resident in the biosphere since most key physiological, ecological and evolutionary life history parameters covary with body size \autocite{peters1983, brown2000-scaling-book,schmidt1984scaling,Marshall2019b}. To quote \cite{Bartholomew1981} ``It is only a slight overestimate to say that the most important attribute of an animal, both physiologically and ecologically, is its size''. As such, growth modelling has historically been a popular endeavor in the biological sciences, demanding a knowledge of the mechanisms which shape resource allocation and evolutionary strategy. This prerequisit has attracted theorists, field ecologists and applied scientists, in a joint endeavor to translate growth as a quantifiable, mathematisable and testable idea into a theoretical, predictive framework \autocite{popper1962,popper1972,peters1983, West2011}. To do so, mathematical biologists have constructed sophisticated mathematical models, using laws from quantitative disciplines, such as the laws of geometry and laws of thermodynamics \& enzyme kinetics, to accurately predict the value of size across ontogeny. Geometric scaling laws are especially releveant to this pursuit since many biological traits scale with body size, governed by a power law: $Y = Y_0 M^{\beta}$, where $Y$ is the biological characteristic to be predicted, $M$ is body mass, and $Y_0$ and $\beta$ are empirically derived constants. These laws have been formalised into ``allometric" equations. If $\beta = 1$, the scaling is said to be ``isometric", while if $\beta \neq 1$, the relationship is called allometric, and plots as a curve on linear axes \autocite{brown2000-scaling-book}.

    Historically, the approaches used to model ontogenetic growth bifurcate into two major branches. Evolutionary Life History Theory, which relates growth, phenomenologically, to the optimum timing of fundamental life history events, and Ecological Metabolic Theory, which relates growth, mechanistically, to fundamental cellular and energetic processes which constrain the scope for growth.
        
    Evolutionary life history and game theorists, concerned with growth from a coarser-level, life history perspective, have typically employed optimisation techniques to solve for the optimal age and size values of given life history events which maximise fitness, e.g. age-at-maturation. The \textit{modus operandi} is to assume that evolution maximises fitness, often quantified by lifetime reproductive output, and that strategies concerning the timing of life-history events are the product of evolution optimising trade-offs among competing traits \autocite{Day1997, Stearns1989, stearns1992evolution}. As such, life-history theory typically makes simplifying assumptions with regard to energetic mechanisms \autocite{Day1997, Kozowski1987-indeterminate}. For instance, those which cause energy distribution and metabolism to scale with body size \autocite{peters1983,Werner1988,West1997,brown2000-scaling-book}. The external evolutionary context is the focus. Models, and their parameters, are driven by selection on body size, and the underlying physiology is thought to evolve in response to those selection pressures.
        
    Converseley, metabolic theorists, concerned with growth at a finer level, utilise laws from thermodynamics and enzyme kinetics as a first-principles approach to growth problems, combining biological knowledge, intuition and mathematics to explain observed ecological phenomena \autocite{Brown2004}. Paradigmatically, everything an organism does in its lifetime, including how it grows, is governed by the distribution and transformation of available energy. Ergo, the chain of causality in the scientific approaches of Metabolic Theory and Life History Theory are the inverse of one another. Life History Theory asks: ``given that these mechanisms exist and scale, what is the predicted optimum strategy?'' whereas Metabiolic Theory asks: ``given that these strategies have evolved to be optimal, what are the energetic mechanisms that explain them?''. Central to energetic models is the idea growth is constrained by an energy scope or profit. An organism garners energy from its environment at a certain rate (``revenue''), some of which it expends on internal maintenance (metabolism) at a certain rate (``cost''). Any surplus energy remaining after this expenditure, can then be used to synthesise new biomass for growth \autocite{Holdway1984, Rochet2001}. Growth slows because expenditure on maintenance scales with mass to a larger exponent than energy intake (different power laws), so this energy profit decreases with size. Extant models agree upon a mass exponent of 1 for maintenance rate (double the body mass = double the number of cells), whereas the mass exponent of intake rate has been debated through time, given its derivation from different geometric mechanisms. The earliest model, developed by \cite{Putter1920} and now associated with the von Bertalanffy growth function \autocite{vonBert1938, VonBertalanffy1957}, derive a value of $2/3$, as energy intake was argued to be governed by absorbtion across a membrane surface (rearrangement of $\pi r^2$). Alternatively, West \textit{et al.} have since argued a value of $3/4$, due to transport via a fractal-like supply network (e.g. capillaries). While the \cite{vonBert1938} and \cite{West2001} may appear mathematically similar in form, their conceptual origins are different \autocite{Barneche2018c}. Together, intake and maintenance make up a difference equation:
    \begin{equation}
        \frac{dm}{dt} = am^{3/4} - bm \label{west_ogm}
    \end{equation}
    Since power laws have the convenient property of the exponent being equal to the slope after a logarithmic transformation, $\log{(am^y)} = y\cdot \log{(am)}$, these scalings can be understood more intuitively when plotted (\cref{growth_schedules}). For determinate growers, these values reach equivalence at an asymptotic mass, when the individual is ``spending'' energy via metabolism as quickly as it can acquire it, thus leaving no surplus for growth.
    \begin{center}
        \begin{minipage}{0.48\linewidth}
        \includegraphics[width=0.49\linewidth]{../Other/Presentation/determinate.pdf}
        \label{growth_schedules}
        \includegraphics[width=0.49\linewidth]{../Other/Presentation/indeterminate.pdf}  
        % \label{indeterminate}
        \captionof{figure}{Determinate growth evolves from having energy intake and maintenance rates which eventually intercept. Indeterminate growers do have a theoretical asymptotic size, due to the finite nature of energy resource, but this is never reached.}
        \end{minipage}%
        \hfill
        \begin{minipage}{0.45\linewidth}
            \includegraphics[width=\linewidth]{../Other/Presentation/logistic_growth_curve.pdf}  
            \label{logistic_growth}
            \captionof{figure}{Logistic Growth. Determinate growers reach asymptotic size before death, where indeterminate do not, hence they appear to grow indefinitely.}
        \end{minipage}
    \end{center}
    Whilst these two branches of theory tend to operate in isolation, several attempts have been made at combining them. To reconcile the two theories, authors have typically derived seperate, energetically-governed growth equations for different ontogenetic stages, e.g. juvenile and mature, to form two-piece or ``biphasic'' models (reviewed in \cite{Wilson2018}) Post-maturity equations usually introduce a new energy loss term representing the rate of energy allocated to reproduction or gonad mass. These hybrids maximise explanatory potential by blending both philosophies to gain a proximate and ultimate understanding of growth \autocite{Marshall2019b}.    

    Intriguingly, despite being an uncontroversially fundamental life history event, most mechanistic models simply consider intake and maintenance \autocite{Marshall2019b}, appearing, at least explicitly, to be agnostic to reproduction, rendering inferences made from these models problematic \autocite{Day1997, Marshall2019b}. Reproduction incurs large energetic costs and increases mortality risk, with some highly fecund vertebrates consisting of 75\% reproductive tissue \autocite{Parker2018}. At the onset of reproduction, different mechanistic dynamics emerge in contrast to the preceding juvenile phase as energetic resources are shunted from growth to reproduction \autocite{Day1997}. Explicit account of reproduction in ontogenetic growth models has recently received great attention since the results of a large meta-study on fish growth were published, which concluded that total fish fecundity, considering clutch size, egg volume and egg energy content, scales hyperallometrically with mass \autocite{Barneche2018d}. In a consequent review of the literature, \cite{Marshall2019b} claim that these results reset theoretical assumptions of growth models, with profound fisheries implications, given that quotas are estimated using spawning potential metrics calculated from these types of model. However, such a grand claim may be premature in its making, since the data analysed by \cite{Barneche2018d} represent batch fecundity at discrete time points, a consequence of the typical sampling technique used to measure gonad properties, involving catch and dissection. These discrete data are not compatible with the continuous rates that growth models are built on (see SI), meaning, in reality, allocation of resources to reproduction in continuous time may not scale hyperallometrically with mass. In fact, when a simple growth model with an added term representing this hyperallometry is simulated, a large parameter space (large mass-at-maturtiy and reproduction scaling exponents), produced shrinking growth trajectories. Since fish do not shed somatic mass over ontogeny, which may be indicative of false approximation of the magnitude of reproduction allocation rate with non-rate data.
    
    Secondly, extant models also fail to consider variable, or environment-dependent, scaling of energy intake rate. Many assume a simple relationship between energy intake rate and resting metabolic rate, such that per-capita energy supply scales with consumer body size ($m$) to an exponent of $3/4$ (see above), irrespective of taxon or environment \autocite{Pawar2012}. Instead, it has been shown, that depending on resource-abundance and foraging dimension, consumption rate can scale to an exponent as large as $1.06$ and as low as $0.85$, the latter being a similar value to the mass-scaling exponent of field metabolic rate \autocite{peters1983,Weibel2004, Pawar2012}. Since fish, or any wild population, experience field conditions throughout life, it may, in fact, be more prudent to assume a relationship between intake rate and field metabolic rate, rather than resting \autocite{Boisclair1993}.
    
    Both of these findings reveal gaps in the fish ontogenetic growth modelling literature. In this study, I use ecological metabolic theory and the \cite{West2001} model, developed by \cite{Charnov2001}, as a framework to esimtate the true size of the mass-scaling exponent of reproduction allocation as a continuous energetic rate in fish mothers. Additionally, I use the consumption-rate findings of \cite{Pawar2012} and updated values of fish caloric equivalents to better inform energy intake values for the model. In doing so, I first map the biologically-feasible space of bivariate fecundity parameter values. Using this space I then optimise the parameters of the growth model to produce the highest amount of lifetime reproduction to test the following hypotheses: \textit{H}1: \textit{The continuous rate of allocation of energetic resources to reproduction scales allometrically with mass in fish mothers}; and \textit{H}2: \textit{Prior frameworks restrict the space of possible fecundity rate parameter values by using unrealistic parameter values for intake rate}
    Answering \textit{H1} is crucial in assessing the validity of the claim that reproductive allocation rate scales hyperallometrically with mass, quantifying and endorsing the distinction between continuous rate data and discrete time data. Answering question \textit{H2}. will be integral to highlighting the theoretical assumptions of extant models, with the potential to warrant update to the $3/4$ mass-scaling of intake rate. Finally, bridging these questions will also provide insight into the validity of the reproductive hyperallometry claim, since the reason we do not observe shrinking trajectories in reality may be because larger intake rate scaling permits larger (hyperallometric) scaling exponents of fecundity. Quantifying the effects of these new findings for fish growth models will have profound implications for fisheries management and for growth modelling as a scientific practice in general.

%%% Methods %%%
\section{Materials and Methods}\thispagestyle{plain}
\textbf{Theory and Hypotheses}

The \cite{West2001} general model is derived from an organism of wet mass $m$ (g), a resting metabolic rate $b$ ($J \cdot d^{-1}$) and a growth rate per unit time of $dm/dt$ ($g \cdot d^{-1}$),
\begin{align}
    \frac{dm}{dt} &= am^x - bm^y \label{west_ogm}
\end{align}
where $a \equiv B_{0}m_{c}/E_{c}$ and $b \equiv B_{c}/E_{c}$. $B_0$ is a metabolic normalisation constant invariant within a taxon, $m_{c}$ is the mass of a single cell, $E_{c}$ is the energy expended to synthesise a single cell ($J \cdot g^{-1}$) and $B_{c}$ is the metabolic rate of a single cell. $x$ and $y$ are dimensionless mass-scaling exponents which are predicted to take values of $3/4$ and $1$, respectively. The $3/4$ scaling of intake rate is set by the relationship between intake rate of energy by individual cells and resting metabolic rate. Resting metabolic rate scales to the $3/4$ exponent of mass due to the fractal architecture of space-filling, hierarchical branching supply networks (e.g. capillaries) whose geometry has evolved due to natural selection optimising energy transport to the cells \autocite{West1997, West2005}. Larger entities do not evolve bigger networks, but the networks become more deeply nested with child branches. This self-similarity of the network at decreasing levels causes the number of terminal units to scale with mass to an exponent of $3/4$, as this geometry approximates a fractal, which is mathematically considered to have a non-integer dimension \autocite{Hausdorff1918, Mandelbrot1982}. This is the mechanism underlying ecology's famous Kleiber's law that, for the vast majority of organisms, resting metabolic rate scales hypoallometrically to the $3/4$ power of the animal's mass \autocite{Kleiber1947, peters1983, niklas1994plant}. The isometric scaling of maintenance ($y = 1$) is set by the linear increase in cells with mass, i.e. if an organism's mass $= m$, then a size $2m$ organism has twice the cells to maintain.

In order to address the agnosticism of this model to reproduction, \cite{Charnov2001} developed the framework to include a term to represent fecundity allocation rate, in order to solve for optimum life history values. Until maturity (age $\alpha$, size $m_{\alpha}$), fish incur costs only from maintenance as they are sexually immature, captured by \cref{west_ogm}. At $\alpha$, a reproduction term is introduced where c is the proportion of body mass allocated to reproduction and $\rho$ is the reproduction mass-scaling exponent. Crucially, \cite{charnov2001} assumed that fecundity rate scales isometrically with size, which is mathematically equivalent to elevating maintenance cost, since the maintenance and reproduction term have equivalent mass-scaling exponents:
\begin{align}
    \frac{dm}{dt} &= am^{3/4} - bm - cm \nonumber \\
    \frac{dm}{dt} &= am^{3/4} - (b+c)m \label{charnov}
\end{align}
Equally, models which do not explicitly consider reproduction at any point(only maintenance, $-bm$) make the same assumption implicitly, since modelling across ontogeny or lifespan assumes progression to maturity, which incurs an energetic cost, which must come from maintenance cost. This again assumes isometric mass-scaling of reproduction allocation rate.

\textit{Hypothesis H}1: \textit{The continuous rate of allocation of energetic resources to reproduction scales allometrically with mass in fish mothers.}\\
\cite{Barneche2018d} and \cite{Marshall2019b} claim that fecundity in fish scales hyperallometrically with body size and consequently, in a recent review of growth models, \cite{Marshall2019b} took particular issue with a cruical assumption that most mechanistic models are guilty of. Specifically, that fecundity rate scales isometrically with mass. They update \cref{charnov} by adding a scaling exponent to the fecundity rate term $cm^{\rho}$ and take a philosophical stand by fitting this model to fish age-at-size data, which fits as well as the \cite{West2001} and von \cite{vonBert1938} models (although they argue this by curve-overlap rather than using a valid model comparison metric such as Akaike or Baysian Information Criterion, which penalise additional parameters.) However, upon deriving the units present in this equation, it becomes apparent that the \cite{Marshall2019b} model is problematic in that it inadvertently reconciles two incompatible quantities. For sake of mathematical accuracy, the units of all terms should be in \textsc{mass/time} in continuous time (see SI for full derivation and unit explanation). However, the (acclaimed hyperallometric) fecundity data reported by \cite{Barneche2018d} were for discrete, batch spawning events, where the typical method of data collection is to catch and dissect a fish and take gonadal measurements at that point in time (Barneche, 2019, pers comm). Collecting this data for different sized fish of the same species and stitching the points together to infer a ``rate'' is not mathematically equivalent to a continuous rate of allocation of resources to reproduction which could then be used for a continuous growth rate measure. To this end, \cite{Marshall2019b} are inferring continuous rate scaling from discrete time data, and, as such, may be premature in their claims.  

\textit{Testing H}1 \\
I tested the validity of this claim using a biphasic, hybrid model which utilises Ecological Metabolic Theory and Life History Theory by capturing the energetics of growth during two distinct ontogenetic stages. Mature fish experience continuous diversion of resources to fecundity which scales to the $\rho$ exponent of mass.
\begin{align}
    \frac{dm}{dt} &= am^{3/4} - bm \ \ \ \ \ \ \ \ \ \ \ \ \ \ m < m_{\alpha} \label{luke_model_juvenile}\\
    \frac{dm}{dt} &= am^{3/4} - bm - cm^{\rho} \ \ \ \ \ m \geq m_{\alpha} \label{luke_model}
\end{align}

The model is based on the LHT concept that assumes that natural selection optimises strategies, e.g. $c$ and $\rho$, to maximise fitness, where lifetime reproductive output can be used as a proxy for fitness, denoted $R_0$, which can be derived from theoretical evolution studies \autocite{Charnov2001, stearns1992evolution}. To this end, the model was analysed via simulations which allowed the fecundity rate parameters $c$ and $\rho$ to vary in order to maximise $R_0$, which is calculated using a life history model, developed from \cite{Charnov2001}. Since the scope for reproduction is determined by how much energy is available, it follows that the optimal values of $c$ and $\rho$ are dependent on the value and scaling of intake rate $am^{x}$, addressed in \textit{H3}. 

At any time $t$, $b_{t}$ is the \textit{effective} energy allocated by fish to reproduction, the product of the physiological allocation of resources $cm^{\rho}$ and an efficiency term $h(m)$ representing a declining efficiency of this allocation, known as reproductive senescence, the natural decline in fecundity as fish age \autocite{Stearns2000, Benoit2018, Vrtilek2018}. This decline begins at maturity ($\alpha$) and is controlled by a variable rate parameter $\kappa$. Fish also experience an extrinsic mortality rate, or actuarial senescence, contained in a surivorship function, $l_t$, which is effectively a declining $\mathbb{P}$(survival to $t$) \autocite{Beverton1959, Peterson1984, Charnov1993,Walters1993, Charnov2001, Benoit2018, Laird2010, Reznick2002, Reznick2006}. (It is important to note than reproductive and acturarial senescence are functions of time or age, whilst allocation to reproduction is a function of mass.) Thus, the instanteous reproductive output at time $t$ is the product $l_{t}b_{t}$ and the lifetime (cumulative) reproductive output is:
\begin{equation}
    R_{0} = \int_{\alpha}^{\infty}l_{t}b_{t} dt
\end{equation}
Since fish live in a juvenile and adult phase, they are subject to varying mortality rates through ontogeny \autocite{Charnov2001}. Juvenile mortality ($t_0 \rightarrow t_{\alpha}$) controls how many fish are recruited into the adult phase and, since it follows an exponential distribution, $l_t = e^{-Z(t)}$ bounded [0,1], it thus acts as a scaling factor, denoted $L_{\alpha}$, for the mature population ($t_{\alpha} \rightarrow t_{\infty}$) \autocite{Charnov1990-agematurity}. For adults survival is relative to when maturity is reached, $l_{t} = e^{-Z(t-\alpha)}$:
\begin{equation}
    R_{0} = c\int_{0}^{\alpha}e^{-Z(t)}dt\int_{\alpha}^{\infty} m(t)^{\rho} e^{-(\kappa+Z)(t-\alpha)} dt \label{LHT_optimisation}
\end{equation}
A common utility in comparative life histories in fish is the invariance of dimensionless quantities derived from the timing of life history events. That is, across species but within a taxon, certain life history variables, representing the timing and magnitude of reproduction form, dimensionless, invariant ratios \autocite{Charnov1990-invariant, Charnov1993}. It has been shown for fish that the ratio of age-at-maturity and mortality rate, $\alpha\cdot Z \approx 2$ \autocite{Charnov1993}. Logically, this invariant makes sense since delaying maturation ($\alpha \approx 2/Z$) is only a feasible strategy if the risk of dying is low enough, or increases less quickly. As such, I employed a rearrangement of this to calculate mortality rate for a given $\alpha$ value.
See SI for full derivation of \cref{LHT_optimisation}.

To perform this optimisation, the analytical goal would be to solve \cref{LHT_optimisation} for values of $c$ and $\rho$ which maximise $R_0$. Since it has no closed-form solution, I simulated this numerically using the \texttt{DifferentialEquations} and \texttt{DiffEqCallbacks} packages in Julia v1.1.1 \autocite{Bezanson2017}, which ran the Rosenbrock optimisation function \autocite{Rosenbrock1960}. The following parameter space was simulated: $0.001 < c < 0.4$ and $0.001 < \rho < 1.25$ \textcolor{red}{justification for these ranges} with 100 linearly-spaced values over a lifespan of $1e6$ days, to ensure all growth trajectory simulations reached asymptotic size (\textcolor{red}{LV Note: but fish don't reach their asymptotic size? Isn't this unrealistic?}). I produced a heatmap of the fecundity rate parameter space, with an optimum $c, \rho$ combination, for a fixed intake rate mass-scaling ($x$) and reproductive senescence rate ($\kappa$). To the best of my knowledge, this study is the first intance of this incorporation of reproductive senescence into a growth and life history model. This approach provided insight into whether hyperallometric scaling of true fecundity-rate is theoretically possible, given the energetic constraints.

\textit{H}2: \textit{Prior frameworks restrict the space of possible fecundity rate parameter values by using unrealistic parameter values for intake rate.} \\
Given the restrictive assumptions underlying resting metabolic rate of no foraging (food is provided \textit{ad libitum}), growing or reproducing, it seems far more prudent to relate intake rate to the mass-scaling of field metabolic rate, which may explain the deviation of consumption rate for $3/4$ scaling. This is especially so for the second and third, which are both violated, since the fundamental purpose of this exercise is to capture growth and the model includes reproduction. Since it is likely that intake rate scales with field metabolic rate, as it is an active (as opposed to resting) metabolic activity, model optimisation was run for intake rate mass exponents $\geq 3/4$. Note that, mathematically, a small alteration to an exponent like this can drastically alter the behaviour of such a model, given that at when $m > 1 g$, the exponent will dominate any changes in the coefficient. Essentially, what I tested for here was whether the non-linearity of intake rate (gain) could compensate for the non-linearity of fecundity rate (loss) by permitting a larger mass-scaling of the latter.

A second, but crucial, flaw in the intake rate values used by \cite{West2001} and \cite{Charnov2001} models was the intake rate coefficient, $a$. In order to theoretically endorse their model fit results for the value of $a$, \cite{West2001} used fundamental cellular properties to derive an approximate value of $a$ (See SI for full derivation). Bioenergetically, $a$ represents the number of cells grown per unit time given the energy available ($\frac{\textsc{mass}}{\textsc{joules}} \cdot \frac{\textsc{joules}}{\textsc{sec}}$). They make the following calculation: Assume incoming rate of energy, $B$, scales with standard metabolic rate, such that $B = B_{0}m^{3/4}$, where $B_0$ is constant for a given taxon. $E_T$ is the energy content of mammalian tissue $\approx 7 \cdot 10^6 J \cdot Kg^{-1}$ and $m_c$ is the mass of a single cell $\approx 3 \cdot 10^{-9} g$, thus $E_c$, the energy required to create a cell \textit{in viro} = $E_T \cdot m_c = (7 \cdot 10^6 JKg^{-1})(3 \cdot 10^{-12} Kg) \approx 2.1 \cdot 10^{-5} J$. They take  $B_0 \approx 1.9 \cdot 10^{-2} W$. By substitution:
\begin{align*}
    a &\equiv \frac{B_{0}m_{c}}{E_{c}} \\
    a &= \frac{(1.9 \cdot 10^{-2} W)(3 \cdot 10^{-9} g)}{2.1 \cdot 10^{-5} J}\\
    a &= 2.71 \cdot 10^{-6} g^{1/4}s^{-1} \\
    2.71 \cdot 10^{-6}&g\cdot s^{-1} \cdot 24 \cdot 60 \cdot 60 \ \ \textsc{   seconds to days}\\
    a &\approx 0.25 g^{1/4}day^{-1}
\end{align*}
They claim this is in ``good agreement'' with the model fit estimate for $a$ in their Table 1, but brief observation reveals that this claim only holds true for mammals, not birds and fish (fish are an order of magnitude lower), an intuitive deduction since they used the energy content of mammalian tissue for $E_T$, taken from \cite{peters1983}. However, further investigation makes apparent the intriguing value they use for $B_0$. This quantity remains constant within a taxon, and \cite{West2001} chose the value known for unicellular organisms, derived from data published by \cite{Hemmingsen1960}, collected by \cite{peters1983}, which included different slope (scaling) values for unicellulars, poikilotherms and homeotherms. Given the deliberate choice to use a caloric equivalent value for mammals only, it is perplexing that they chose to ignore the $B_0$ value for homeotherms.

\textit{Testing H}2 \\
Given my aim to model growth and life history in fish, this choice is not only of particular interest but is crucial given that this endeavour mandates accurate values for fixed parameters, such as $a$, in order for optimised free parameters to be biologically realistic. To this end, I altered their calculation of $a$ to include values for the same cellular parameters but which are accurate to fish. Tissue energy content $E_T$ for fish was calculated as the average from caloric equivalents across 70 fish species (see SI) \autocite{Cummins1971, Steimle1980, Hartman1995}, converted from $kJ\cdot g^{-1}$ to $JKg^{-1}$ using ``per gram of wet weight'' values, the same metric used by \cite{West2001}. Repeating the same calculation: $E_T$ is the energy content of fish tissue $= 5.63 \cdot 10^3 J\cdot g^{-1}$ and $m_c$ is the mass of a single cell $\approx 3 \cdot 10^{-9} \textsc{g}$, thus $E_c$, the energy required to create a cell \textit{in viro} = $1.69 \cdot 10^{-5} J$. $B_0 \approx 1.4 \cdot 10^{-1} W$ for poikilotherms. By substitution:
\begin{align*}
    a &\equiv \frac{B_{0}m_{c}}{E_{c}} \\
    a &= \frac{(1.4 \cdot 10^{-1} W)(3 \cdot 10^{-9} g)}{1.69 \cdot 10^{-5} J}\\
    a &= 2.4867 \cdot 10^{-5}g\cdot s^{-1} \\
    2.4867 \cdot 10^{-5}&g\cdot s^{-1} \cdot 24 \cdot 60 \cdot 60 \ \ \textsc{   seconds to days}\\
    a &= 2.1485 g^{1/4}\cdot day^{-1}
\end{align*}

Since the model results in some growth curves which exhibit shrinking (i.e. loss of mass at maturity), when simulated, I first obtained the feasible parameter space of $c$ and $\rho$ values at my given $\alpha$, which did not produce shrinking (see SI for full method explanation). To test hypothesis \textit{H2}, I increased the scaling of intake rate with the updated, fixed $a$ coefficient, to see if the feasible fecundity-rate parameter space, as well as the optimum $c, \rho$ combination changed in response.

% \begin{table}[h]
%     \caption{Parameter values for model fitting from \cite{West2001}}
%     \begin{center}
%     \begin{tabular}{|l|l|l|l|l|}
%     \hline
%     Organism            & $a$   & $m_0$   & $M$     & Slope \\ \hline
%     Cow                 & 0.28  & 33.3 kg & 442kg   & 1.08  \\ \hline
%     Pig                 & 0.31  & 0.90 kg & 320kg   & 1.08  \\ \hline
%     Rabbit              & 0.36  & 0.12 kg & 1.35 kg & 1.34  \\ \hline
%     Guinea pig          & 0.21  & 5 g     & 840g    & 0.91  \\ \hline
%     Rat                 & 0.23  & 8 g     & 280g    & 1.07  \\ \hline
%     Shrew               & 0.83  & 0.3 g   & 4.2 g   & 0.98  \\ \hline
%     Salmon              & 0.026 & 0.01 g  & 2.4 kg  & 1.01  \\ \hline
%     Guppy               & 0.10  & 0.008 g & 0.15 g  & 1.04  \\ \hline
%     Shrimp              & 0.027 & 0.0008g & 0.075g  & 0.82  \\ \hline
%     \end{tabular}
%     \end{center}
% \end{table}

%%% Results %%%
\section{Results and Discussion}\thispagestyle{plain}
Production of a fecundity-rate feasibility heatmap proved necessary to obtain growth curves which did not shrink, but instead experienced an inflection, where growth rate remained positive ($dm/dt > 0$) as energy is diverted to reproduction at age $\alpha$ (see \cref{growth_curve}).
\begin{center}
    \begin{minipage}{0.8\linewidth}
        \includegraphics[width=0.8\linewidth]{../Results/single_curve_with_onset.pdf}
        \captionof{figure}{Example growth curve showing an inflection at maturity when $\alpha = 200$, as opposed to shrinking, which would be rejected by the optimisation algorithm since shrinking in fish is not biologically possible. At maturity, growth rate slows (inflection) due to the diversion of resource to fecundity, leaving less scope for growth. Simultaneously, lifetime reproduction (cumulative) increases to an asymptote, when this quantity is less and less likely to increase given the exponential decay of survivorship probability, $l_t$.} 
        \label{growth_curve}
    \end{minipage}\\
\end{center}
\vspace{0.5cm}
\textbf{Hypothesis \textit{H}1} \\
The life history optimisation results show that, theoretically, the continuous rate of reproductive allocation in mature fish does exhibit an allometric scaling relationship with mass ($\rho \neq 1$) however, contrary to \cite{Marshall2019b}'s claim, this is not \textit{hyperallometric}. In fact, results suggest that the relationship is instead hypoallometric, ($\rho < 1$), with a surprisingly low optimum $\rho = 0.06$. Evidently, for the canonical $3/4$ scaling of intake rate and $\alpha$, the fecundity rate parameter space and values themselves which do not elicit shrinking of body mass are both small. This is due to the fact that $3/4$ mass-scaling of intake rate is not large enough to overcome even small values of $\rho$, which dominates the fecundity rate term. As such, when a fish matures, the combined cost of maintenance, and reproduction outweighs intake rate and $dm/dt < 0$. The result for $c$ suggests that the theoretical optimum is to devote 17\% of body mass to feundity per day, which conforms to the existing literature, which suggest 10-25\%. Results also appear unaffected by a changing $\kappa$, suggeting that the decline in fecundity is not does not occur at a large enough magnitude to overcome the investment in reproduction itself.
\begin{center}
    \begin{minipage}{0.5\linewidth}
    \includegraphics[width=\linewidth]{{../Results/opt_hm_Alph=200.00_a=2.15_x=0.75_k=0.01}.pdf}
    \captionof{figure}{Optimum fecundity rate parameters $\rho,c$ \\ when $am^x = (2.15)m^{0.75}, \kappa = 0.01$}
    \end{minipage}%
    % \hfill
    \begin{minipage}{0.5\linewidth}
    \includegraphics[width=\linewidth]{{../Results/opt_hm_Alph=200.00_a=2.15_x=0.75_k=0.10}.pdf}  
    \captionof{figure}{Optimum fecundity rate parameters $\rho,c$ \\ when $am^x = (2.15)m^{0.75}, \kappa = 0.10$}
    \end{minipage}\\
\end{center} 
\vspace{0.5cm}
\textbf{Hypothesis \textit{H}2} \\
Increasing the value of the intake rate scaling exponent evidently permits larger values for the fecundity rate coefficient and scaling exponents by translating the curved parameter space upwards in the $\rho$ plane. An intuitive result, since $x$ now scales steeply enough to overcome larger fecundity rate parameters, i.e. compensate for the loss of energy that \textit{would} cause shrinking. \Crefrange{0.85, 0.01}{0.85, 0.1} reveal an intrinsic property of the fecundity rate parameter space, that its shape remains constant across the different intake rate allometries. Specifically, the range of feasible $c$ values is larger than the range of feasible $\rho$ values. This, again, makes mathematical sense due to different behaviours of a scalar ($c$) versus an exponent $\rho$, the latter dominating the term, hence having a narrow range of smaller feasible values. When $x$ is increased to 0.85, the optimum $\rho = 0.63$, substantially greater than at $x = 0.75$. 

\begin{center}
    \begin{minipage}{0.5\linewidth}
        \includegraphics[width=\linewidth]{{../Results/opt_hm_Alph=200.00_a=2.15_x=0.85_k=0.01}.pdf}  
        \captionof{figure}{Optimum fecundity rate parameters $\rho,c$ \\ when $am^x = (2.15)m^{0.85}, \kappa = 0.01$}
        \label{0.85, 0.01}
    \end{minipage}%
    % \hfill
    \begin{minipage}{0.5\linewidth}
        \includegraphics[width=\linewidth]{{../Results/opt_hm_Alph=200.00_a=2.15_x=0.85_k=0.10}.pdf}    
        \captionof{figure}{Optimum fecundity rate parameters $\rho,c$ \\ when $am^x = (2.15)m^{0.85}, \kappa = 0.10$}
        \label{0.85, 0.1}
    \end{minipage}
\end{center}

These results highlight a caveat of the model, which is that the fixed parameter $\alpha$ has a fundamental effect on the feasible parameter space. The aforementioned $\alpha Z$ invariant does, of course, cause the life history model (\cref{LHT_optimisation}) to behave the same regardless of the chosen $\alpha$, since $Z$ compensates. However, this invariant does not discipline the growth model (\cref{luke_model}), which is where predictive power begins to be lost. The results presented reflect $\alpha = 200$, or a fish maturity age of 200 days. However, I predict that adjusting $\alpha$ will have profound effects on the optimum fecundity rate parameter values, due to their relatedness to mass. Suppose $\alpha$ is set at a larger value, e.g. 400 days. This means that for double the amount of time, our hypothetical fish is governed only by \cref{luke_model_juvenile}, which incurs less cost (no reproduction), thus in this time the fish can grow larger. At $\alpha$, when it matures, it has already reached a larger size, thus the reproduction term takes on a much larger value, especially due to $\rho$. This sudden and larger diversion of resources causes $dm/dt < 0$, or shrinking. This is, in fact, how the feasible parameter space in the model is calculated. Suppose, for a given $c, \rho$ combination, a fish is born mature, thus incurring a $cm^{\rho}$ cost for its whole lifespan, if this trajectory's $m_{\infty}$ is smaller than $m_{\alpha}$ when maturity is delayed (e.g. $\alpha = 200$), then this fish will always shrink under this model. When fish mature very early on ($\alpha \rightarrow 0$), they can never reach a size $m_{\alpha} > m_{\infty}$ because they incur these costs from birth. Thus, I predict that at larger values of $\alpha$, only very small values for $\rho$ are possible, if not at all, across a fixed intake rate. In the case that $\rho \approx 0$ and $c \rightarrow 0$, this indicates that reproducing at that age, at all, is not possible, unless another quantity changes, e.g. intake exponent increases. Alternatively, this would indicate that the architecture of the model itself is not realistic, in the sense that fish do not suddenly become mature in the timescale of a single day and incur an immediately large cost. Instead, they either allocate to fecundity from a very early age while remaining sexually immature, termed ``the dissipative processes of respiration''. Or, in reality, the timescale of the juvenile phase is almost negligible in contrast to the timescale of the lifetime, hence they are only governed by \cref{luke_model} \autocite{West2001}. 
% Need a heatmap of $a = 0.02 $ to prove that West values don't work and validate my change in H2

%%% Conclusion %%%
\section{Conclusion}\thispagestyle{plain}
\lipsum

%%% Bibliography %%%
\addcontentsline{toc}{section}{Bibliography}
\newpage\let\mkbibnamefamily\textsc\printbibliography[title=Bibliography]\thispagestyle{plain} % Sets author names to small caps

%%% SI %%%
\addcontentsline{toc}{section}{Supplementary Information}
% \includepdf[pages=-]{Vassor_L_J_CMEE_Thesis_2019_Supplementary_Information.pdf}

\end{document}